<!DOCTYPE html>
<html lang="ja">

<head>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <title>
  Tutorial1 - NicolNaviの基本操作 · NicoNicoNnavi
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="NicoNavi">
<meta name="description" content="
  1. 概要
  
    
    見出しへのリンク
  

泥質片岩の顕微鏡動画を用いて NicolNavi の基本操作を習得するためのチュートリアルです。記載された手順に従うと、ステージ回転動画の前処理から粒界抽出、鉱物ラベルの設定、モード組成および形状定向配列の確認までを一通り実施できます。

  2. 前提条件
  
    
    見出しへのリンク
  


NicolNavi アプリケーションが起動済みで、対象プロジェクトが開かれていること
サンプル動画 nicolnavi_app/Examples/pelitic-schist-xpl.avi を参照できること


  3. 画面構成
  
    
    見出しへのリンク
  


左画面：解析対象画像のビューア。粒界やラベルの表示を確認できます。
右画面：番号付きボタン、パラメータ入力欄、チェックボックスが並ぶ操作パネルです。
画面中央部：Image list で左画面に表示する画像を選択します。


  4. 操作フロー
  
    
    見出しへのリンク
  


  4.1 動画ファイルの読み込み
  
    
    見出しへのリンク
  


右画面の 1 Select を押します。
ファイル選択ダイアログで nicolnavi_app/Examples/pelitic-schist-xpl.avi を選択し、開くを押します。
左画面に動画の先頭フレームが幅 1000 px の画像として表示されることを確認します。



  4.2 前処理の実行
  
    
    見出しへのリンク
  


2 Start を押し、動画の離散化と回転中心推定を開始します。
処理が完了すると、自動的に回転中心調整画面へ遷移します。



  4.3 回転中心の調整
  
    
    見出しへのリンク
  


左画面の同心円状パターンの中心に赤い十字が一致しているか確認します。
中心がずれている場合は ＋ − ボタンで座標を微調整します（今回の例ではほとんどずれていないためスキップ可能です）。
調整後、3 Continue を押して回転中心を確定します。


  4.4 解析結果の確認
  
    
    見出しへのリンク
  


自動遷移後の画面で Image list を開き、以下の代表的な解析マップを確認します。


  
      
          マップ
          説明
      
  
  
      
          color
          ステージ 1 回転中で最も明るい瞬間の色情報です。
      
      
          extinction color
          最も暗くなる瞬間の色情報です。完全な消光が得られない場合は前工程を見直してください。
      
      
          R
          各ピクセルのレタデーション値です。Video タブで指定したレタデーションを探索します。今回は最大レタデーションを max retardation = 300 のまま使用しているため、石英以外の鉱物では値の信頼性が低い点に注意してください。
      
      
          extinction angle
          各ピクセルの光消角マップです。
      
      
          raw image
          加工していない画像です。たとえば、$\phi = 22.5\degree$を選択すると、顕微鏡ステージが、22.5$\degree$回転したときの動画のフレームを示します。
      
  



  
    Warning
  
  extinction color 全体が暗くならない場合は、カメラ画素の飽和や不適切な前処理が疑われます。このような例に対する処理は、Tutorial2で行います。



  4.5 粒界抽出パラメータの調整
  
    
    見出しへのリンク
  


右画面のパラメータ欄で目的に合わせて初期値を設定します。
6 Detect Grain Boundary を押し、左画面に粒界線が重ね表示されることを確認します。
4 median filter と 5 parameters を下図のように調整します。
6 Calculate grain boundaries を再度押して結果を更新します。



図：左は初期設定での粒界推定結果、右はパラメータ調整後の結果

  
      
          パラメータ
          説明
      
  
  
      
          median filter
          ノイズ低減用の平滑化サイズ。大き過ぎる値は微細構造を消します。
      
      
          boundary detection sensitivity
          粒界抽出の感度。高くすると細部まで抽出しますが誤検出も増えます。
      
      
          boundary connectivity
          途切れた境界を連結とみなす最大距離（px）。大き過ぎる値は不要な連結を生みます。
      
      
          smallest grain size
          px^2 単位の最小粒径。値未満の領域はノイズとして除去されます。
      
  


  
    Info
  
  粒界抽出は試行錯誤が前提です。Show grain boundary チェックボックスを活用し、結果を逐次確認してください。



  
    Warning
  
  単一の設定で全鉱物ペアを完全に分離できるとは限りません。対象によっては鉱物ごとに条件を変えて処理する必要があります。



  4.6 粒界抽出結果の確定
  
    
    見出しへのリンク
  


抽出結果が意図どおりになったことを確認します。
7 Continue を押し、次のラベル付与画面へ進みます。



  5. 鉱物ラベルの付与と確認
  
    
    見出しへのリンク
  


  5.1 ラベル付与の準備
  
    
    見出しへのリンク
  


パラメータ欄の 8 Label Name に mica などの鉱物名を入力します。
9 Add Label を押し、ラベル付与モードへ切り替えます。
同じ手順で other minerals のラベルも追加します。



ラベル一覧の 10 mica を選択し、左画面で該当鉱物の粒子をクリックして教師データを 5～10 個程度追加します。




  5.2 ラベル精度の向上
  
    
    見出しへのリンク
  


10 mica と 11 other minerals のラジオボタンを切り替え、それぞれの粒子に該当する部分を左画面から選択して教師データを追加します。
初期状態では、誤判定が多数ありますが、ラベルの追加を繰り返すことで誤判定が減少していきます。
画面表示の透過度や粒界表示はチェックボックスで切り替え、ラベルが正確に割り当てられているか確認してください。
必要に応じてラベル名横のカラーボックスをクリックし、表示色を変更します。


図：`other minerals` を選択した後の表示例（個々の環境で色分布は異なります）

  
    Info
  
  ラベル付与にはラベル伝搬法を使用しています。全粒子数のおよそ 20% 以上を教師データとして指定すると分類結果が得られます。今回の例では 144 個の粒子にラベルを付与しました。



  5.3 ラベル設定の確定
  
    
    見出しへのリンク
  


すべての粒界領域に適切なラベルが付いていることを確認します。
12 Done を押し、ラベル設定を確定します。



  6. 岩石組織の定量化（雲母の例）
  
    
    見出しへのリンク
  


  6.1 ローズダイアグラムで定向配列を確認する
  
    
    見出しへのリンク
  


13 other minerals チェックボックスをオフにします。
ビュー選択で 14 rose diagram および 15 shape preferred orientation を選びます。
右画面の 16 information に表示される統計値を読み取ります。



表示例：">
<meta name="keywords" content="blog,developer,personal">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Tutorial1 - NicolNaviの基本操作">
  <meta name="twitter:description" content="1. 概要 見出しへのリンク 泥質片岩の顕微鏡動画を用いて NicolNavi の基本操作を習得するためのチュートリアルです。記載された手順に従うと、ステージ回転動画の前処理から粒界抽出、鉱物ラベルの設定、モード組成および形状定向配列の確認までを一通り実施できます。
2. 前提条件 見出しへのリンク NicolNavi アプリケーションが起動済みで、対象プロジェクトが開かれていること サンプル動画 nicolnavi_app/Examples/pelitic-schist-xpl.avi を参照できること 3. 画面構成 見出しへのリンク 左画面：解析対象画像のビューア。粒界やラベルの表示を確認できます。 右画面：番号付きボタン、パラメータ入力欄、チェックボックスが並ぶ操作パネルです。 画面中央部：Image list で左画面に表示する画像を選択します。 4. 操作フロー 見出しへのリンク 4.1 動画ファイルの読み込み 見出しへのリンク 右画面の 1 Select を押します。 ファイル選択ダイアログで nicolnavi_app/Examples/pelitic-schist-xpl.avi を選択し、開くを押します。 左画面に動画の先頭フレームが幅 1000 px の画像として表示されることを確認します。 4.2 前処理の実行 見出しへのリンク 2 Start を押し、動画の離散化と回転中心推定を開始します。 処理が完了すると、自動的に回転中心調整画面へ遷移します。 4.3 回転中心の調整 見出しへのリンク 左画面の同心円状パターンの中心に赤い十字が一致しているか確認します。 中心がずれている場合は ＋ − ボタンで座標を微調整します（今回の例ではほとんどずれていないためスキップ可能です）。 調整後、3 Continue を押して回転中心を確定します。 4.4 解析結果の確認 見出しへのリンク 自動遷移後の画面で Image list を開き、以下の代表的な解析マップを確認します。 マップ 説明 color ステージ 1 回転中で最も明るい瞬間の色情報です。 extinction color 最も暗くなる瞬間の色情報です。完全な消光が得られない場合は前工程を見直してください。 R 各ピクセルのレタデーション値です。Video タブで指定したレタデーションを探索します。今回は最大レタデーションを max retardation = 300 のまま使用しているため、石英以外の鉱物では値の信頼性が低い点に注意してください。 extinction angle 各ピクセルの光消角マップです。 raw image 加工していない画像です。たとえば、$\phi = 22.5\degree$を選択すると、顕微鏡ステージが、22.5$\degree$回転したときの動画のフレームを示します。 Warning extinction color 全体が暗くならない場合は、カメラ画素の飽和や不適切な前処理が疑われます。このような例に対する処理は、Tutorial2で行います。 4.5 粒界抽出パラメータの調整 見出しへのリンク 右画面のパラメータ欄で目的に合わせて初期値を設定します。 6 Detect Grain Boundary を押し、左画面に粒界線が重ね表示されることを確認します。 4 median filter と 5 parameters を下図のように調整します。 6 Calculate grain boundaries を再度押して結果を更新します。 図：左は初期設定での粒界推定結果、右はパラメータ調整後の結果 パラメータ 説明 median filter ノイズ低減用の平滑化サイズ。大き過ぎる値は微細構造を消します。 boundary detection sensitivity 粒界抽出の感度。高くすると細部まで抽出しますが誤検出も増えます。 boundary connectivity 途切れた境界を連結とみなす最大距離（px）。大き過ぎる値は不要な連結を生みます。 smallest grain size px^2 単位の最小粒径。値未満の領域はノイズとして除去されます。 Info 粒界抽出は試行錯誤が前提です。Show grain boundary チェックボックスを活用し、結果を逐次確認してください。 Warning 単一の設定で全鉱物ペアを完全に分離できるとは限りません。対象によっては鉱物ごとに条件を変えて処理する必要があります。 4.6 粒界抽出結果の確定 見出しへのリンク 抽出結果が意図どおりになったことを確認します。 7 Continue を押し、次のラベル付与画面へ進みます。 5. 鉱物ラベルの付与と確認 見出しへのリンク 5.1 ラベル付与の準備 見出しへのリンク パラメータ欄の 8 Label Name に mica などの鉱物名を入力します。 9 Add Label を押し、ラベル付与モードへ切り替えます。 同じ手順で other minerals のラベルも追加します。 ラベル一覧の 10 mica を選択し、左画面で該当鉱物の粒子をクリックして教師データを 5～10 個程度追加します。 5.2 ラベル精度の向上 見出しへのリンク 10 mica と 11 other minerals のラジオボタンを切り替え、それぞれの粒子に該当する部分を左画面から選択して教師データを追加します。 初期状態では、誤判定が多数ありますが、ラベルの追加を繰り返すことで誤判定が減少していきます。 画面表示の透過度や粒界表示はチェックボックスで切り替え、ラベルが正確に割り当てられているか確認してください。 必要に応じてラベル名横のカラーボックスをクリックし、表示色を変更します。 図：`other minerals` を選択した後の表示例（個々の環境で色分布は異なります） Info ラベル付与にはラベル伝搬法を使用しています。全粒子数のおよそ 20% 以上を教師データとして指定すると分類結果が得られます。今回の例では 144 個の粒子にラベルを付与しました。 5.3 ラベル設定の確定 見出しへのリンク すべての粒界領域に適切なラベルが付いていることを確認します。 12 Done を押し、ラベル設定を確定します。 6. 岩石組織の定量化（雲母の例） 見出しへのリンク 6.1 ローズダイアグラムで定向配列を確認する 見出しへのリンク 13 other minerals チェックボックスをオフにします。 ビュー選択で 14 rose diagram および 15 shape preferred orientation を選びます。 右画面の 16 information に表示される統計値を読み取ります。 表示例：">

<meta property="og:url" content="https://tan-furukawa.github.io/niconavi/ja/tutorial/tutorial1/">
  <meta property="og:site_name" content="NicoNicoNnavi">
  <meta property="og:title" content="Tutorial1 - NicolNaviの基本操作">
  <meta property="og:description" content="1. 概要 見出しへのリンク 泥質片岩の顕微鏡動画を用いて NicolNavi の基本操作を習得するためのチュートリアルです。記載された手順に従うと、ステージ回転動画の前処理から粒界抽出、鉱物ラベルの設定、モード組成および形状定向配列の確認までを一通り実施できます。
2. 前提条件 見出しへのリンク NicolNavi アプリケーションが起動済みで、対象プロジェクトが開かれていること サンプル動画 nicolnavi_app/Examples/pelitic-schist-xpl.avi を参照できること 3. 画面構成 見出しへのリンク 左画面：解析対象画像のビューア。粒界やラベルの表示を確認できます。 右画面：番号付きボタン、パラメータ入力欄、チェックボックスが並ぶ操作パネルです。 画面中央部：Image list で左画面に表示する画像を選択します。 4. 操作フロー 見出しへのリンク 4.1 動画ファイルの読み込み 見出しへのリンク 右画面の 1 Select を押します。 ファイル選択ダイアログで nicolnavi_app/Examples/pelitic-schist-xpl.avi を選択し、開くを押します。 左画面に動画の先頭フレームが幅 1000 px の画像として表示されることを確認します。 4.2 前処理の実行 見出しへのリンク 2 Start を押し、動画の離散化と回転中心推定を開始します。 処理が完了すると、自動的に回転中心調整画面へ遷移します。 4.3 回転中心の調整 見出しへのリンク 左画面の同心円状パターンの中心に赤い十字が一致しているか確認します。 中心がずれている場合は ＋ − ボタンで座標を微調整します（今回の例ではほとんどずれていないためスキップ可能です）。 調整後、3 Continue を押して回転中心を確定します。 4.4 解析結果の確認 見出しへのリンク 自動遷移後の画面で Image list を開き、以下の代表的な解析マップを確認します。 マップ 説明 color ステージ 1 回転中で最も明るい瞬間の色情報です。 extinction color 最も暗くなる瞬間の色情報です。完全な消光が得られない場合は前工程を見直してください。 R 各ピクセルのレタデーション値です。Video タブで指定したレタデーションを探索します。今回は最大レタデーションを max retardation = 300 のまま使用しているため、石英以外の鉱物では値の信頼性が低い点に注意してください。 extinction angle 各ピクセルの光消角マップです。 raw image 加工していない画像です。たとえば、$\phi = 22.5\degree$を選択すると、顕微鏡ステージが、22.5$\degree$回転したときの動画のフレームを示します。 Warning extinction color 全体が暗くならない場合は、カメラ画素の飽和や不適切な前処理が疑われます。このような例に対する処理は、Tutorial2で行います。 4.5 粒界抽出パラメータの調整 見出しへのリンク 右画面のパラメータ欄で目的に合わせて初期値を設定します。 6 Detect Grain Boundary を押し、左画面に粒界線が重ね表示されることを確認します。 4 median filter と 5 parameters を下図のように調整します。 6 Calculate grain boundaries を再度押して結果を更新します。 図：左は初期設定での粒界推定結果、右はパラメータ調整後の結果 パラメータ 説明 median filter ノイズ低減用の平滑化サイズ。大き過ぎる値は微細構造を消します。 boundary detection sensitivity 粒界抽出の感度。高くすると細部まで抽出しますが誤検出も増えます。 boundary connectivity 途切れた境界を連結とみなす最大距離（px）。大き過ぎる値は不要な連結を生みます。 smallest grain size px^2 単位の最小粒径。値未満の領域はノイズとして除去されます。 Info 粒界抽出は試行錯誤が前提です。Show grain boundary チェックボックスを活用し、結果を逐次確認してください。 Warning 単一の設定で全鉱物ペアを完全に分離できるとは限りません。対象によっては鉱物ごとに条件を変えて処理する必要があります。 4.6 粒界抽出結果の確定 見出しへのリンク 抽出結果が意図どおりになったことを確認します。 7 Continue を押し、次のラベル付与画面へ進みます。 5. 鉱物ラベルの付与と確認 見出しへのリンク 5.1 ラベル付与の準備 見出しへのリンク パラメータ欄の 8 Label Name に mica などの鉱物名を入力します。 9 Add Label を押し、ラベル付与モードへ切り替えます。 同じ手順で other minerals のラベルも追加します。 ラベル一覧の 10 mica を選択し、左画面で該当鉱物の粒子をクリックして教師データを 5～10 個程度追加します。 5.2 ラベル精度の向上 見出しへのリンク 10 mica と 11 other minerals のラジオボタンを切り替え、それぞれの粒子に該当する部分を左画面から選択して教師データを追加します。 初期状態では、誤判定が多数ありますが、ラベルの追加を繰り返すことで誤判定が減少していきます。 画面表示の透過度や粒界表示はチェックボックスで切り替え、ラベルが正確に割り当てられているか確認してください。 必要に応じてラベル名横のカラーボックスをクリックし、表示色を変更します。 図：`other minerals` を選択した後の表示例（個々の環境で色分布は異なります） Info ラベル付与にはラベル伝搬法を使用しています。全粒子数のおよそ 20% 以上を教師データとして指定すると分類結果が得られます。今回の例では 144 個の粒子にラベルを付与しました。 5.3 ラベル設定の確定 見出しへのリンク すべての粒界領域に適切なラベルが付いていることを確認します。 12 Done を押し、ラベル設定を確定します。 6. 岩石組織の定量化（雲母の例） 見出しへのリンク 6.1 ローズダイアグラムで定向配列を確認する 見出しへのリンク 13 other minerals チェックボックスをオフにします。 ビュー選択で 14 rose diagram および 15 shape preferred orientation を選びます。 右画面の 16 information に表示される統計値を読み取ります。 表示例：">
  <meta property="og:locale" content="ja">
  <meta property="og:type" content="article">
    <meta property="article:section" content="tutorial">
    <meta property="article:published_time" content="2025-10-15T13:10:14+09:00">
    <meta property="article:modified_time" content="2025-10-15T13:10:14+09:00">




<link rel="canonical" href="https://tan-furukawa.github.io/niconavi/ja/tutorial/tutorial1/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/niconavi/css/coder.min.24022876d48fb15813406bbe8c1c4d3b9ab49378f6ff34712fff078e2c04ac12.css" integrity="sha256-JAIodtSPsVgTQGu&#43;jBxNO5q0k3j2/zRxL/8HjiwErBI=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/niconavi/css/coder-dark.min.f7e815ec05a254f4b89393ec609b48ef12a7894283e81d06f3804eb939b90bc7.css" integrity="sha256-9&#43;gV7AWiVPS4k5PsYJtI7xKniUKD6B0G84BOuTm5C8c=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/img/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://tan-furukawa.github.io/niconavi/ja/">
      NicoNicoNnavi
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/niconavi/ja/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/niconavi/ja/install/">Install</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/niconavi/ja/acquisition/">Data Acquisition</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/niconavi/ja/tutorial/">Tutorial</a>
            </li>
          
        
        
          
          
          
            
              
                <li class="navigation-item menu-separator">
                  <span>|</span>
                </li>
                
              
              <li class="navigation-item">
                <a href="/niconavi/tutorial/tutorial1/">EN</a>
              </li>
            
          
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container page">
  <article>
    <header>
      <h1 class="title">
        <a class="title-link" href="https://tan-furukawa.github.io/niconavi/ja/tutorial/tutorial1/">
          Tutorial1 - NicolNaviの基本操作
        </a>
      </h1>
    </header>

    <h2 id="1-概要">
  1. 概要
  <a class="heading-link" href="#1-%e6%a6%82%e8%a6%81">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h2>
<p>泥質片岩の顕微鏡動画を用いて NicolNavi の基本操作を習得するためのチュートリアルです。記載された手順に従うと、ステージ回転動画の前処理から粒界抽出、鉱物ラベルの設定、モード組成および形状定向配列の確認までを一通り実施できます。</p>
<h2 id="2-前提条件">
  2. 前提条件
  <a class="heading-link" href="#2-%e5%89%8d%e6%8f%90%e6%9d%a1%e4%bb%b6">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h2>
<ul>
<li>NicolNavi アプリケーションが起動済みで、対象プロジェクトが開かれていること</li>
<li>サンプル動画 <code>nicolnavi_app/Examples/pelitic-schist-xpl.avi</code> を参照できること</li>
</ul>
<h2 id="3-画面構成">
  3. 画面構成
  <a class="heading-link" href="#3-%e7%94%bb%e9%9d%a2%e6%a7%8b%e6%88%90">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h2>
<ul>
<li>左画面：解析対象画像のビューア。粒界やラベルの表示を確認できます。</li>
<li>右画面：番号付きボタン、パラメータ入力欄、チェックボックスが並ぶ操作パネルです。</li>
<li>画面中央部：<code>Image list</code> で左画面に表示する画像を選択します。</li>
</ul>
<h2 id="4-操作フロー">
  4. 操作フロー
  <a class="heading-link" href="#4-%e6%93%8d%e4%bd%9c%e3%83%95%e3%83%ad%e3%83%bc">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h2>
<h3 id="41-動画ファイルの読み込み">
  4.1 動画ファイルの読み込み
  <a class="heading-link" href="#41-%e5%8b%95%e7%94%bb%e3%83%95%e3%82%a1%e3%82%a4%e3%83%ab%e3%81%ae%e8%aa%ad%e3%81%bf%e8%be%bc%e3%81%bf">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li>右画面の <code>1 Select</code> を押します。</li>
<li>ファイル選択ダイアログで <code>nicolnavi_app/Examples/pelitic-schist-xpl.avi</code> を選択し、開くを押します。</li>
<li>左画面に動画の先頭フレームが幅 1000 px の画像として表示されることを確認します。</li>
</ol>
<img src="https://tan-furukawa.github.io/niconavi/images/page/tutorial/tutorial1/pic1.png" style="width: 30%;">
<h3 id="42-前処理の実行">
  4.2 前処理の実行
  <a class="heading-link" href="#42-%e5%89%8d%e5%87%a6%e7%90%86%e3%81%ae%e5%ae%9f%e8%a1%8c">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li><code>2 Start</code> を押し、動画の離散化と回転中心推定を開始します。</li>
<li>処理が完了すると、自動的に回転中心調整画面へ遷移します。</li>
</ol>
<img src="https://tan-furukawa.github.io/niconavi/images/page/tutorial/tutorial1/pic2.png" style="width: 100%;">
<h3 id="43-回転中心の調整">
  4.3 回転中心の調整
  <a class="heading-link" href="#43-%e5%9b%9e%e8%bb%a2%e4%b8%ad%e5%bf%83%e3%81%ae%e8%aa%bf%e6%95%b4">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li>左画面の同心円状パターンの中心に赤い十字が一致しているか確認します。</li>
<li>中心がずれている場合は <code>＋</code> <code>−</code> ボタンで座標を微調整します（今回の例ではほとんどずれていないためスキップ可能です）。</li>
<li>調整後、<code>3 Continue</code> を押して回転中心を確定します。</li>
</ol>
<h3 id="44-解析結果の確認">
  4.4 解析結果の確認
  <a class="heading-link" href="#44-%e8%a7%a3%e6%9e%90%e7%b5%90%e6%9e%9c%e3%81%ae%e7%a2%ba%e8%aa%8d">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li>自動遷移後の画面で <code>Image list</code> を開き、以下の代表的な解析マップを確認します。</li>
</ol>
<table>
  <thead>
      <tr>
          <th>マップ</th>
          <th>説明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>color</code></td>
          <td>ステージ 1 回転中で最も明るい瞬間の色情報です。</td>
      </tr>
      <tr>
          <td><code>extinction color</code></td>
          <td>最も暗くなる瞬間の色情報です。完全な消光が得られない場合は前工程を見直してください。</td>
      </tr>
      <tr>
          <td><code>R</code></td>
          <td>各ピクセルのレタデーション値です。<code>Video</code> タブで指定したレタデーションを探索します。今回は最大レタデーションを <code>max retardation = 300</code> のまま使用しているため、石英以外の鉱物では値の信頼性が低い点に注意してください。</td>
      </tr>
      <tr>
          <td><code>extinction angle</code></td>
          <td>各ピクセルの光消角マップです。</td>
      </tr>
      <tr>
          <td><code>raw image</code></td>
          <td>加工していない画像です。たとえば、$\phi = 22.5\degree$を選択すると、顕微鏡ステージが、22.5$\degree$回転したときの動画のフレームを示します。</td>
      </tr>
  </tbody>
</table>
<img src="https://tan-furukawa.github.io/niconavi/images/page/tutorial/tutorial1/pic3.png" style="width: 100%;">
<div class="notice warning">
  <div class="notice-title">
    <i class="fa-solid fa-exclamation-triangle" aria-hidden="true"></i>Warning
  </div>
  <div class="notice-content"><code>extinction color</code> 全体が暗くならない場合は、カメラ画素の飽和や不適切な前処理が疑われます。このような例に対する処理は、Tutorial2で行います。</div>
</div>

<h3 id="45-粒界抽出パラメータの調整">
  4.5 粒界抽出パラメータの調整
  <a class="heading-link" href="#45-%e7%b2%92%e7%95%8c%e6%8a%bd%e5%87%ba%e3%83%91%e3%83%a9%e3%83%a1%e3%83%bc%e3%82%bf%e3%81%ae%e8%aa%bf%e6%95%b4">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li>右画面のパラメータ欄で目的に合わせて初期値を設定します。</li>
<li><code>6 Detect Grain Boundary</code> を押し、左画面に粒界線が重ね表示されることを確認します。</li>
<li><code>4 median filter</code> と <code>5 parameters</code> を下図のように調整します。</li>
<li><code>6 Calculate grain boundaries</code> を再度押して結果を更新します。</li>
</ol>
<img src="https://tan-furukawa.github.io/niconavi/images/page/tutorial/tutorial1/pic4.png" style="width: 30%;">
<img src="https://tan-furukawa.github.io/niconavi/images/page/tutorial/tutorial1/pic5.png" style="width: 100%;">
図：左は初期設定での粒界推定結果、右はパラメータ調整後の結果
<table>
  <thead>
      <tr>
          <th>パラメータ</th>
          <th>説明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>median filter</strong></td>
          <td>ノイズ低減用の平滑化サイズ。大き過ぎる値は微細構造を消します。</td>
      </tr>
      <tr>
          <td><strong>boundary detection sensitivity</strong></td>
          <td>粒界抽出の感度。高くすると細部まで抽出しますが誤検出も増えます。</td>
      </tr>
      <tr>
          <td><strong>boundary connectivity</strong></td>
          <td>途切れた境界を連結とみなす最大距離（px）。大き過ぎる値は不要な連結を生みます。</td>
      </tr>
      <tr>
          <td><strong>smallest grain size</strong></td>
          <td><code>px^2</code> 単位の最小粒径。値未満の領域はノイズとして除去されます。</td>
      </tr>
  </tbody>
</table>
<div class="notice info">
  <div class="notice-title">
    <i class="fa-solid fa-exclamation-circle" aria-hidden="true"></i>Info
  </div>
  <div class="notice-content">粒界抽出は試行錯誤が前提です。<code>Show grain boundary</code> チェックボックスを活用し、結果を逐次確認してください。</div>
</div>

<div class="notice warning">
  <div class="notice-title">
    <i class="fa-solid fa-exclamation-triangle" aria-hidden="true"></i>Warning
  </div>
  <div class="notice-content">単一の設定で全鉱物ペアを完全に分離できるとは限りません。対象によっては鉱物ごとに条件を変えて処理する必要があります。</div>
</div>

<h3 id="46-粒界抽出結果の確定">
  4.6 粒界抽出結果の確定
  <a class="heading-link" href="#46-%e7%b2%92%e7%95%8c%e6%8a%bd%e5%87%ba%e7%b5%90%e6%9e%9c%e3%81%ae%e7%a2%ba%e5%ae%9a">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li>抽出結果が意図どおりになったことを確認します。</li>
<li><code>7 Continue</code> を押し、次のラベル付与画面へ進みます。</li>
</ol>
<img src="https://tan-furukawa.github.io/niconavi/images/page/tutorial/tutorial1/pic6.png" style="width: 100%;">
<h2 id="5-鉱物ラベルの付与と確認">
  5. 鉱物ラベルの付与と確認
  <a class="heading-link" href="#5-%e9%89%b1%e7%89%a9%e3%83%a9%e3%83%99%e3%83%ab%e3%81%ae%e4%bb%98%e4%b8%8e%e3%81%a8%e7%a2%ba%e8%aa%8d">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h2>
<h3 id="51-ラベル付与の準備">
  5.1 ラベル付与の準備
  <a class="heading-link" href="#51-%e3%83%a9%e3%83%99%e3%83%ab%e4%bb%98%e4%b8%8e%e3%81%ae%e6%ba%96%e5%82%99">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li>パラメータ欄の <code>8 Label Name</code> に <code>mica</code> などの鉱物名を入力します。</li>
<li><code>9 Add Label</code> を押し、ラベル付与モードへ切り替えます。</li>
<li>同じ手順で <code>other minerals</code> のラベルも追加します。</li>
</ol>
<img src="https://tan-furukawa.github.io/niconavi/images/page/tutorial/tutorial1/pic7.png" style="width: 100%;">
<ol start="4">
<li>ラベル一覧の <code>10 mica</code> を選択し、左画面で該当鉱物の粒子をクリックして教師データを 5～10 個程度追加します。</li>
</ol>
<img src="https://tan-furukawa.github.io/niconavi/images/page/tutorial/tutorial1/pic8.png" style="width: 30%;">
<img src="https://tan-furukawa.github.io/niconavi/images/page/tutorial/tutorial1/pic9.png" style="width: 100%;">
<h3 id="52-ラベル精度の向上">
  5.2 ラベル精度の向上
  <a class="heading-link" href="#52-%e3%83%a9%e3%83%99%e3%83%ab%e7%b2%be%e5%ba%a6%e3%81%ae%e5%90%91%e4%b8%8a">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li><code>10 mica</code> と <code>11 other minerals</code> のラジオボタンを切り替え、それぞれの粒子に該当する部分を左画面から選択して教師データを追加します。</li>
<li>初期状態では、誤判定が多数ありますが、ラベルの追加を繰り返すことで誤判定が減少していきます。</li>
<li>画面表示の透過度や粒界表示はチェックボックスで切り替え、ラベルが正確に割り当てられているか確認してください。</li>
<li>必要に応じてラベル名横のカラーボックスをクリックし、表示色を変更します。</li>
</ol>
<img src="https://tan-furukawa.github.io/niconavi/images/page/tutorial/tutorial1/pic10.png" style="width: 100%;">
図：`other minerals` を選択した後の表示例（個々の環境で色分布は異なります）
<div class="notice info">
  <div class="notice-title">
    <i class="fa-solid fa-exclamation-circle" aria-hidden="true"></i>Info
  </div>
  <div class="notice-content">ラベル付与にはラベル伝搬法を使用しています。全粒子数のおよそ 20% 以上を教師データとして指定すると分類結果が得られます。今回の例では 144 個の粒子にラベルを付与しました。</div>
</div>

<h3 id="53-ラベル設定の確定">
  5.3 ラベル設定の確定
  <a class="heading-link" href="#53-%e3%83%a9%e3%83%99%e3%83%ab%e8%a8%ad%e5%ae%9a%e3%81%ae%e7%a2%ba%e5%ae%9a">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li>すべての粒界領域に適切なラベルが付いていることを確認します。</li>
<li><code>12 Done</code> を押し、ラベル設定を確定します。</li>
</ol>
<img src="https://tan-furukawa.github.io/niconavi/images/page/tutorial/tutorial1/pic11.png" style="width: 100%;">
<h2 id="6-岩石組織の定量化雲母の例">
  6. 岩石組織の定量化（雲母の例）
  <a class="heading-link" href="#6-%e5%b2%a9%e7%9f%b3%e7%b5%84%e7%b9%94%e3%81%ae%e5%ae%9a%e9%87%8f%e5%8c%96%e9%9b%b2%e6%af%8d%e3%81%ae%e4%be%8b">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h2>
<h3 id="61-ローズダイアグラムで定向配列を確認する">
  6.1 ローズダイアグラムで定向配列を確認する
  <a class="heading-link" href="#61-%e3%83%ad%e3%83%bc%e3%82%ba%e3%83%80%e3%82%a4%e3%82%a2%e3%82%b0%e3%83%a9%e3%83%a0%e3%81%a7%e5%ae%9a%e5%90%91%e9%85%8d%e5%88%97%e3%82%92%e7%a2%ba%e8%aa%8d%e3%81%99%e3%82%8b">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li><code>13 other minerals</code> チェックボックスをオフにします。</li>
<li>ビュー選択で <code>14 rose diagram</code> および <code>15 shape preferred orientation</code> を選びます。</li>
<li>右画面の <code>16 information</code> に表示される統計値を読み取ります。</li>
</ol>
<img src="https://tan-furukawa.github.io/niconavi/images/page/tutorial/tutorial1/pic12.png" style="width: 30%;">
<img src="https://tan-furukawa.github.io/niconavi/images/page/tutorial/tutorial1/pic13.png" style="width: 100%;">
<p>表示例：</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Mean orientation: bulk: 171.952°, mica: 171.952°
</span></span><span style="display:flex;"><span>Circular variance: bulk: 0.458, mica: 0.458
</span></span></code></pre></div><p>平均配向角（Mean orientation）は雲母の形状定向配列を示し、円分散（Circular variance）は 0 に近いほど配向が揃い、1 に近いほどランダム性が高いことを表します。</p>
<h3 id="62-spo-ビューと楕円近似を確認する">
  6.2 SPO ビューと楕円近似を確認する
  <a class="heading-link" href="#62-spo-%e3%83%93%e3%83%a5%e3%83%bc%e3%81%a8%e6%a5%95%e5%86%86%e8%bf%91%e4%bc%bc%e3%82%92%e7%a2%ba%e8%aa%8d%e3%81%99%e3%82%8b">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li><code>14 rose diagram</code> の代わりに <code>SPO</code> を選択します。</li>
<li><code>Image list</code> から <code>ellipse</code> を選び、粒子を楕円近似した図を表示します。</li>
</ol>
<img src="https://tan-furukawa.github.io/niconavi/images/page/tutorial/tutorial1/pic14.png" style="width: 100%;">
<h3 id="63-粒子形状の散布図を確認する">
  6.3 粒子形状の散布図を確認する
  <a class="heading-link" href="#63-%e7%b2%92%e5%ad%90%e5%bd%a2%e7%8a%b6%e3%81%ae%e6%95%a3%e5%b8%83%e5%9b%b3%e3%82%92%e7%a2%ba%e8%aa%8d%e3%81%99%e3%82%8b">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li>ビューを <code>scatter</code> に切り替えます。</li>
<li>軸設定を <code>x: ellipse major axis length</code>、<code>y: ellipse minor axis length</code> に変更します。</li>
<li>散布図と回帰直線から、粒子形状のおおよその軸比を読み取ります（例：回帰直線 <code>y = 0.224 x</code> なら軸比約 0.224:1 = 1:3.2）。</li>
</ol>
<img src="https://tan-furukawa.github.io/niconavi/images/page/tutorial/tutorial1/pic15.png" style="width: 100%;">
<h3 id="64-モード組成面積比の確認">
  6.4 モード組成（面積比）の確認
  <a class="heading-link" href="#64-%e3%83%a2%e3%83%bc%e3%83%89%e7%b5%84%e6%88%90%e9%9d%a2%e7%a9%8d%e6%af%94%e3%81%ae%e7%a2%ba%e8%aa%8d">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li>ビューを <code>histogram</code> に変更します。</li>
<li><code>16 other minerals</code> チェックボックスをオンにします。</li>
<li>解析量を <code>17 retardation</code> から <code>size</code> に変更し、面積に基づくヒストグラムを表示します。</li>
</ol>
<img src="https://tan-furukawa.github.io/niconavi/images/page/tutorial/tutorial1/pic16.png" style="width: 100%;">
<img src="https://tan-furukawa.github.io/niconavi/images/page/tutorial/tutorial1/pic17.png" style="width: 100%;">
<p>表示例：</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Mean: bulk: 394.808, mica: 558.211, other minerals: 383.620
</span></span><span style="display:flex;"><span>Std Dev: bulk: 1807.601, mica: 493.803, other minerals: 1863.461
</span></span><span style="display:flex;"><span>Min: bulk: 14.000, mica: 17.000, other minerals: 14.000
</span></span><span style="display:flex;"><span>Max: bulk: 36946.000, mica: 1814.000, other minerals: 36946.000
</span></span><span style="display:flex;"><span>Mode: bulk: 24.000, mica: 130.000, other minerals: 24.000
</span></span><span style="display:flex;"><span>Count: bulk: 593, mica: 38, other minerals: 555
</span></span><span style="display:flex;"><span>Integral ratio: mica: 9.06%, other minerals: 90.94%
</span></span><span style="display:flex;"><span>Count ratio: mica: 6.41%, other minerals: 93.59%
</span></span></code></pre></div><p><code>Integral ratio</code> はヒストグラムの積分値を用いた面積比を表します。上記の例では、雲母（mica）のモード組成は約 9.1% と読み取れます。</p>
<h2 id="7-まとめ">
  7. まとめ
  <a class="heading-link" href="#7-%e3%81%be%e3%81%a8%e3%82%81">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h2>
<ul>
<li>本書の手順で、ステージ回転動画の前処理から粒界抽出、鉱物ラベル付与、組織解析まで一通り実行できます。</li>
<li>粒界抽出とラベル伝搬は試行錯誤が必要です。結果が安定しない場合はパラメータと教師データのバランスを再調整してください。</li>
<li>解析結果は <code>information</code> 欄の数値およびグラフ表示で必ず検証し、撮影条件や試料特性との整合性を確認してください。</li>
</ul>

  </article>
</section>

  

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2025
     NicoNavi 
    ·
    
    Powered by 
    Tan Furukawa
    
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/niconavi/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
