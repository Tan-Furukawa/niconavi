<!DOCTYPE html>
<html lang="ja">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <title>
  Tutorial2 - 鉱物の抽出と可視化 · NicoNicoNnavi
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="NicoNavi">
<meta name="description" content="
  1. 概要
  
    
    見出しへのリンク
  

セクターゾーニングしたざくろ石（garnet）の顕微鏡動画を題材に、鉱物ごとの粒界抽出と光学的異方性の可視化手順を解説します。Tutorial 1 で学んだ基本操作を土台に、単結晶内部の消光挙動を強調するための設定変更や、鉱物ごとのラベル付与を実践します。

  2. 前提条件
  
    
    見出しへのリンク
  


NicolNavi アプリケーションが起動済みで、対象プロジェクトが開かれていること
サンプル動画 nicolnavi_app/Examples/sector_zoning.avi を参照できること
Tutorial 1 の操作（前処理・粒界抽出・ラベル付与）を一通り試していること


  3. 操作フロー
  
    
    見出しへのリンク
  


  3.1 動画ファイルの読み込み
  
    
    見出しへのリンク
  


右画面の Select を押します。
ファイル選択ダイアログで nicolnavi_app/Examples/sector_zoning.avi を選択し、開くを押します。
左画面に動画の先頭フレームが幅 1000 px の正方形画像として表示されることを確認します。
Start を押し、動画の離散化と回転中心推定を開始します。


  3.2 回転中心の調整
  
    
    見出しへのリンク
  


処理完了後、自動的に回転中心調整画面へ遷移します。



このデータでは自動検出された中心が実際の同心円パターンから外れています。cx と cy をクリックし、赤い十字を実際の中心に合わせてください。


図：中心を手動調整した状態

調整後、Continue を押して回転中心を確定します。


  3.3 解析マップと明度補正の確認
  
    
    見出しへのリンク
  


画面遷移後に Image list を開き、代表的な解析マップを確認します。


  
      
          マップ
          説明
      
  
  
      
          color
          ステージ 1 回転中で最も明るい瞬間の色情報です。
      
      
          extinction color
          最も暗くなる瞬間の色情報です。完全な消光が得られない場合は前工程を見直してください。
      
      
          R
          各ピクセルのレタデーション値です。Video タブで指定したレタデーションを探索します。
      
      
          extinction angle
          各ピクセルの光消角マップです。
      
      
          raw image
          未加工の画像です。例えば phi = 22.5° を選ぶと、その回転角でのフレームを表示します。
      
  


color と extinction color を切り替えると、color の方が暗く表示される場合があります。


図：Image list が color のとき">
<meta name="keywords" content="blog,developer,personal">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Tutorial2 - 鉱物の抽出と可視化">
  <meta name="twitter:description" content="1. 概要 見出しへのリンク セクターゾーニングしたざくろ石（garnet）の顕微鏡動画を題材に、鉱物ごとの粒界抽出と光学的異方性の可視化手順を解説します。Tutorial 1 で学んだ基本操作を土台に、単結晶内部の消光挙動を強調するための設定変更や、鉱物ごとのラベル付与を実践します。
2. 前提条件 見出しへのリンク NicolNavi アプリケーションが起動済みで、対象プロジェクトが開かれていること サンプル動画 nicolnavi_app/Examples/sector_zoning.avi を参照できること Tutorial 1 の操作（前処理・粒界抽出・ラベル付与）を一通り試していること 3. 操作フロー 見出しへのリンク 3.1 動画ファイルの読み込み 見出しへのリンク 右画面の Select を押します。 ファイル選択ダイアログで nicolnavi_app/Examples/sector_zoning.avi を選択し、開くを押します。 左画面に動画の先頭フレームが幅 1000 px の正方形画像として表示されることを確認します。 Start を押し、動画の離散化と回転中心推定を開始します。 3.2 回転中心の調整 見出しへのリンク 処理完了後、自動的に回転中心調整画面へ遷移します。 このデータでは自動検出された中心が実際の同心円パターンから外れています。cx と cy をクリックし、赤い十字を実際の中心に合わせてください。 図：中心を手動調整した状態 調整後、Continue を押して回転中心を確定します。 3.3 解析マップと明度補正の確認 見出しへのリンク 画面遷移後に Image list を開き、代表的な解析マップを確認します。 マップ 説明 color ステージ 1 回転中で最も明るい瞬間の色情報です。 extinction color 最も暗くなる瞬間の色情報です。完全な消光が得られない場合は前工程を見直してください。 R 各ピクセルのレタデーション値です。Video タブで指定したレタデーションを探索します。 extinction angle 各ピクセルの光消角マップです。 raw image 未加工の画像です。例えば phi = 22.5° を選ぶと、その回転角でのフレームを表示します。 color と extinction color を切り替えると、color の方が暗く表示される場合があります。 図：Image list が color のとき">

<meta property="og:url" content="http://localhost:1313/ja/tutorial/tutorial2/">
  <meta property="og:site_name" content="NicoNicoNnavi">
  <meta property="og:title" content="Tutorial2 - 鉱物の抽出と可視化">
  <meta property="og:description" content="1. 概要 見出しへのリンク セクターゾーニングしたざくろ石（garnet）の顕微鏡動画を題材に、鉱物ごとの粒界抽出と光学的異方性の可視化手順を解説します。Tutorial 1 で学んだ基本操作を土台に、単結晶内部の消光挙動を強調するための設定変更や、鉱物ごとのラベル付与を実践します。
2. 前提条件 見出しへのリンク NicolNavi アプリケーションが起動済みで、対象プロジェクトが開かれていること サンプル動画 nicolnavi_app/Examples/sector_zoning.avi を参照できること Tutorial 1 の操作（前処理・粒界抽出・ラベル付与）を一通り試していること 3. 操作フロー 見出しへのリンク 3.1 動画ファイルの読み込み 見出しへのリンク 右画面の Select を押します。 ファイル選択ダイアログで nicolnavi_app/Examples/sector_zoning.avi を選択し、開くを押します。 左画面に動画の先頭フレームが幅 1000 px の正方形画像として表示されることを確認します。 Start を押し、動画の離散化と回転中心推定を開始します。 3.2 回転中心の調整 見出しへのリンク 処理完了後、自動的に回転中心調整画面へ遷移します。 このデータでは自動検出された中心が実際の同心円パターンから外れています。cx と cy をクリックし、赤い十字を実際の中心に合わせてください。 図：中心を手動調整した状態 調整後、Continue を押して回転中心を確定します。 3.3 解析マップと明度補正の確認 見出しへのリンク 画面遷移後に Image list を開き、代表的な解析マップを確認します。 マップ 説明 color ステージ 1 回転中で最も明るい瞬間の色情報です。 extinction color 最も暗くなる瞬間の色情報です。完全な消光が得られない場合は前工程を見直してください。 R 各ピクセルのレタデーション値です。Video タブで指定したレタデーションを探索します。 extinction angle 各ピクセルの光消角マップです。 raw image 未加工の画像です。例えば phi = 22.5° を選ぶと、その回転角でのフレームを表示します。 color と extinction color を切り替えると、color の方が暗く表示される場合があります。 図：Image list が color のとき">
  <meta property="og:locale" content="ja">
  <meta property="og:type" content="article">
    <meta property="article:section" content="tutorial">
    <meta property="article:published_time" content="2025-10-15T13:10:14+09:00">
    <meta property="article:modified_time" content="2025-10-15T13:10:14+09:00">




<link rel="canonical" href="http://localhost:1313/ja/tutorial/tutorial2/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.css" media="screen">






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.css" media="screen">
  



 




<link rel="icon" type="image/svg+xml" href="/img/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="http://localhost:1313/ja/">
      NicoNicoNnavi
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/ja/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/ja/install/">Install</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/ja/acquisition/">Data Acquisition</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/ja/tutorial/">Tutorial</a>
            </li>
          
        
        
          
          
          
            
              
                <li class="navigation-item menu-separator">
                  <span>|</span>
                </li>
                
              
              <li class="navigation-item">
                <a href="/tutorial/tutorial2/">EN</a>
              </li>
            
          
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container page">
  <article>
    <header>
      <h1 class="title">
        <a class="title-link" href="http://localhost:1313/ja/tutorial/tutorial2/">
          Tutorial2 - 鉱物の抽出と可視化
        </a>
      </h1>
    </header>

    <h2 id="1-概要">
  1. 概要
  <a class="heading-link" href="#1-%e6%a6%82%e8%a6%81">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h2>
<p>セクターゾーニングしたざくろ石（garnet）の顕微鏡動画を題材に、鉱物ごとの粒界抽出と光学的異方性の可視化手順を解説します。Tutorial 1 で学んだ基本操作を土台に、単結晶内部の消光挙動を強調するための設定変更や、鉱物ごとのラベル付与を実践します。</p>
<h2 id="2-前提条件">
  2. 前提条件
  <a class="heading-link" href="#2-%e5%89%8d%e6%8f%90%e6%9d%a1%e4%bb%b6">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h2>
<ul>
<li>NicolNavi アプリケーションが起動済みで、対象プロジェクトが開かれていること</li>
<li>サンプル動画 <code>nicolnavi_app/Examples/sector_zoning.avi</code> を参照できること</li>
<li>Tutorial 1 の操作（前処理・粒界抽出・ラベル付与）を一通り試していること</li>
</ul>
<h2 id="3-操作フロー">
  3. 操作フロー
  <a class="heading-link" href="#3-%e6%93%8d%e4%bd%9c%e3%83%95%e3%83%ad%e3%83%bc">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h2>
<h3 id="31-動画ファイルの読み込み">
  3.1 動画ファイルの読み込み
  <a class="heading-link" href="#31-%e5%8b%95%e7%94%bb%e3%83%95%e3%82%a1%e3%82%a4%e3%83%ab%e3%81%ae%e8%aa%ad%e3%81%bf%e8%be%bc%e3%81%bf">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li>右画面の <code>Select</code> を押します。</li>
<li>ファイル選択ダイアログで <code>nicolnavi_app/Examples/sector_zoning.avi</code> を選択し、開くを押します。</li>
<li>左画面に動画の先頭フレームが幅 1000 px の正方形画像として表示されることを確認します。</li>
<li><code>Start</code> を押し、動画の離散化と回転中心推定を開始します。</li>
</ol>
<h3 id="32-回転中心の調整">
  3.2 回転中心の調整
  <a class="heading-link" href="#32-%e5%9b%9e%e8%bb%a2%e4%b8%ad%e5%bf%83%e3%81%ae%e8%aa%bf%e6%95%b4">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li>処理完了後、自動的に回転中心調整画面へ遷移します。</li>
</ol>
<img src="/images/page/tutorial/tutorial2/pic1.png" style="width: 100%;">
<ol start="2">
<li>このデータでは自動検出された中心が実際の同心円パターンから外れています。<code>cx</code> と <code>cy</code> をクリックし、赤い十字を実際の中心に合わせてください。</li>
</ol>
<img src="/images/page/tutorial/tutorial2/pic2.png" style="width: 100%;">
図：中心を手動調整した状態
<ol start="3">
<li>調整後、<code>Continue</code> を押して回転中心を確定します。</li>
</ol>
<h3 id="33-解析マップと明度補正の確認">
  3.3 解析マップと明度補正の確認
  <a class="heading-link" href="#33-%e8%a7%a3%e6%9e%90%e3%83%9e%e3%83%83%e3%83%97%e3%81%a8%e6%98%8e%e5%ba%a6%e8%a3%9c%e6%ad%a3%e3%81%ae%e7%a2%ba%e8%aa%8d">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li>画面遷移後に <code>Image list</code> を開き、代表的な解析マップを確認します。</li>
</ol>
<table>
  <thead>
      <tr>
          <th>マップ</th>
          <th>説明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>color</code></td>
          <td>ステージ 1 回転中で最も明るい瞬間の色情報です。</td>
      </tr>
      <tr>
          <td><code>extinction color</code></td>
          <td>最も暗くなる瞬間の色情報です。完全な消光が得られない場合は前工程を見直してください。</td>
      </tr>
      <tr>
          <td><code>R</code></td>
          <td>各ピクセルのレタデーション値です。<code>Video</code> タブで指定したレタデーションを探索します。</td>
      </tr>
      <tr>
          <td><code>extinction angle</code></td>
          <td>各ピクセルの光消角マップです。</td>
      </tr>
      <tr>
          <td><code>raw image</code></td>
          <td>未加工の画像です。例えば <code>phi = 22.5°</code> を選ぶと、その回転角でのフレームを表示します。</td>
      </tr>
  </tbody>
</table>
<ol start="2">
<li><code>color</code> と <code>extinction color</code> を切り替えると、<code>color</code> の方が暗く表示される場合があります。</li>
</ol>
<img src="/images/page/tutorial/tutorial2/pic3.png" style="width: 80%;">
<p>図：<code>Image list</code> が <code>color</code> のとき</p>
<img src="/images/page/tutorial/tutorial2/pic4.png" style="width: 80%;">
<p>図：<code>Image list</code> が <code>extinction color</code> のとき</p>
<ol start="3">
<li>
<p><code>color</code> では既定で <strong>brightness correction</strong> が有効になっており、各座標 <code>(x, y)</code> について一回転中の最大明度を \(B_{\max}(x, y)\)、最小明度を \(B_{\min}(x, y)\) とすると、表示値は</p>
\[
   I_{\text{corr}}(x, y) = B_{\max}(x, y) - B_{\min}(x, y)
   \]<p>として計算されます。画像の干渉色をより正しい色調で表現するために行われる処理です。しかし、撮影時に画素が飽和すると \(B_{\max}(x, y) \approx B_{\min}(x, y)\) となり、<code>color</code> の明度が過小評価されて暗く見えます。</p>
</li>
<li>
<p>飽和が疑われる場合は右画面の <strong>brightness correction</strong> チェックボックスをオフにし、</p>
\[
   I_{\text{corr}}(x, y) = B_{\max}(x, y)
   \]<p>をそのまま表示して明度を確認します。</p>
</li>
</ol>
<img src="/images/page/tutorial/tutorial2/pic5.png" style="width: 80%;">
<p>図：<code>Image list</code> が <code>color</code> で、<code>brightness correction</code>のチェックを外したとき</p>
<h3 id="34-粒界抽出の実行">
  3.4 粒界抽出の実行
  <a class="heading-link" href="#34-%e7%b2%92%e7%95%8c%e6%8a%bd%e5%87%ba%e3%81%ae%e5%ae%9f%e8%a1%8c">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li><strong>brightness correction</strong> の設定を確認したら、<code>Detect Grain Boundary</code> を押して粒界の初期推定結果を表示します。</li>
<li><code>median filter</code> や <code>parameters</code> を必要に応じて調整します。今回は <code>boundary connectivity</code> を 5 に変更しました。</li>
<li><code>Calculate grain boundaries</code> を再度押し、調整結果を反映します。</li>
<li>粒界が意図どおりになったら、<code>Continue</code> を押してラベル付与画面へ進みます。</li>
</ol>
<img src="/images/page/tutorial/tutorial2/pic6.png" style="width: 30%;">
<h3 id="35-鉱物ラベルの付与">
  3.5 鉱物ラベルの付与
  <a class="heading-link" href="#35-%e9%89%b1%e7%89%a9%e3%83%a9%e3%83%99%e3%83%ab%e3%81%ae%e4%bb%98%e4%b8%8e">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li>パラメータ欄の <code>Label Name</code> に <code>garnet</code> を入力し、<code>+</code> を押します。同様に <code>inclusion</code>、<code>matrix</code> も追加します。</li>
<li>ラベル一覧から <code>garnet</code> を選択し、ざくろ石に該当する粒子を左画面でクリックして教師データを追加します。</li>
<li><code>inclusion</code> と <code>matrix</code> も同様に、該当する領域を 5～10 個ずつ目安にラベル付けします。</li>
<li>誤判定が多い場合はラベルの追加を繰り返し、結果が安定したら <code>Done</code> を押してラベル設定を確定します。今回の例では合計 48 粒子を教師データとして指定しました。</li>
</ol>
<img src="/images/page/tutorial/tutorial2/pic7.png" style="width: 100%;">
<h3 id="36-光学的異方性の可視化">
  3.6 光学的異方性の可視化
  <a class="heading-link" href="#36-%e5%85%89%e5%ad%a6%e7%9a%84%e7%95%b0%e6%96%b9%e6%80%a7%e3%81%ae%e5%8f%af%e8%a6%96%e5%8c%96">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h3>
<ol>
<li><code>Analysis</code> タブに切り替え、<code>inclusion</code> と <code>matrix</code> のチェックを外してざくろ石のみを表示します。</li>
</ol>
<img src="/images/page/tutorial/tutorial2/pic8.png" style="width: 30%;">
<ol start="2">
<li><code>map</code> タブに戻り、<code>image list</code> から <code>extinction angle</code> を選択します。選択した鉱物以外は黒く表示され、ざくろ石内部のセクターゾーニングが強調されます。</li>
</ol>
<img src="/images/page/tutorial/tutorial2/pic9.png" style="width: 100%;">
<ol start="3">
<li>必要に応じて画面上部のメニューから <code>Save as PDF</code> を選択し、可視化結果を PDF として保存します。</li>
</ol>
<div class="notice info">
  <div class="notice-title">
    <i class="fa-solid fa-exclamation-circle" aria-hidden="true"></i>Info
  </div>
  <div class="notice-content">光学異方性の可視化は、波状消光を示す単結晶にも有効です。</div>
</div>

<h2 id="4-まとめ">
  4. まとめ
  <a class="heading-link" href="#4-%e3%81%be%e3%81%a8%e3%82%81">
    <i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク"></i>
    <span class="sr-only">見出しへのリンク</span>
  </a>
</h2>
<ul>
<li>画素飽和が疑われる場合は <strong>brightness correction</strong> を無効化し、<code>color</code> の明度を補正してください。</li>
<li>鉱物ラベルを正確に付与すると、<code>extinction angle</code> などのマップを鉱物別に抽出でき、鉱物を適切な形状で切り抜いて可視化することが可能になります。</li>
</ul>

  </article>
</section>

  

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2025
     NicoNavi 
    ·
    
    Powered by 
    Tan Furukawa
    
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.js"></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
